#!/bin/bash
cat 1.Input.ALL | grep -aiE ':::$' > 2.Input.Users
for i in {1..5}; do for rule in /usr/share/hashcat/rules/aEverything.rule; do hashcat -m 1000 -a 0 2.Noble.2024.11.25.Users 1.Basic_Pass.lst -r "$rule" --potfile-path=Basic.potfile; done; cut -d ':' -f2 Basic.potfile | sort | uniq >> 1.Basic_Pass.lst; sort -u -o 1.Basic_Pass.lst 1.Basic_Pass.lst; done
echo "Affected user count: $(hashcat -m 1000 -a 0 2.Input.Users --potfile-path=Basic.potfile --show --username | wc -l)" > 5.Basic_Results.txt
echo "Unique Password Count: $(hashcat -m 1000 -a 0 2.Input.Users --potfile-path=Basic.potfile --show --username | cut -d ':' -f3 | sort | uniq | wc -l)" >> 5.Basic_Results.txt
echo "Duplicate passwords over 2 count" >> 5.Basic_Results.txt
hashcat -m 1000 -a 0 2.Input.Users --potfile-path=Basic.potfile --show --username | cut -d ':' -f3 | sort | uniq -c | sort -rn | awk '$1 >= 2' >> 5.Basic_Results.txt
hashcat -m 1000 -a 0 2.Input.Users --potfile-path=Basic.potfile --show --username | cut -d ':' -f1 | sort > 3.Basic_cracked_users.txt
echo "" >> 5.Basic_Results.txt
echo "Password Lengths:" >> 5.Basic_Results.txt
hashcat -m 1000 -a 0 2.Input.Users --potfile-path=Basic.potfile --show --username | cut -d ':' -f3 | sort > 4.Basic_cracked_pass.txt
awk 'length($1) > 0 {print length($1)}' "4.Basic_cracked_pass.txt" | sort -n | uniq -c | awk '{print $2 " characters : " $1}' >> 5.Basic_Results.txt

for i in {1..2}; do for rule in /usr/share/hashcat/rules/T0XlCv2.rule.rule; do hashcat -m 1000 -a 0 2.Input.Users rockyou.lst -r "$rule" --potfile-path=Full.potfile; done; cut -d ':' -f2 Full.potfile | sort | uniq >> rockyou.lst; sort -u -o rockyou.lst rockyou.lst; done
for i in {1..2}; do for rule in /usr/share/hashcat/rules/aEverything.rule; do hashcat -m 1000 -a 0 2.Input.Users rockyou.lst -r "$rule" --potfile-path=Full.potfile; done; cut -d ':' -f2 Full.potfile | sort | uniq >> rockyou.lst; sort -u -o rockyou.lst rockyou.lst; done
echo "Affected user count: $(hashcat -m 1000 -a 0 2.Input.Users --potfile-path=Full.potfile --show --username | wc -l)" > 5.Full_Results.txt
echo "Unique Password Count: $(hashcat -m 1000 -a 0 2.Input.Users --potfile-path=Full.potfile --show --username | cut -d ':' -f3 | sort | uniq | wc -l)" >> 5.Full_Results.txt
echo "Duplicate passwords over 2 count" >> 5.Full_Results.txt
hashcat -m 1000 -a 0 2.Input.Users --potfile-path=Full.potfile --show --username | cut -d ':' -f3 | sort | uniq -c | sort -rn | awk '$1 >= 2' >> 5.Full_Results.txt
hashcat -m 1000 -a 0 2.Input.Users --potfile-path=Full.potfile --show --username | cut -d ':' -f1 | sort > 3.Full_cracked_users.txt
echo "" >> 5.Full_Results.txt
echo "Password Lengths:" >> 5.Full_Results.txt
hashcat -m 1000 -a 0 2.Input.Users --potfile-path=Full.potfile --show --username | cut -d ':' -f3 | sort > 4.Full_cracked_pass.txt
awk 'length($1) > 0 {print length($1)}' "4.Full_cracked_pass.txt" | sort -n | uniq -c | awk '{print $2 " characters : " $1}' >> 5.Full_Results.txt
